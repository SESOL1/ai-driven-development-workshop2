# 工場設備監視システム - 機能要件定義書

## 1. アプリケーション開発の目的や背景

### 1.1 開発目的
工場設備の稼働監視における以下の課題を解決するため、IoT技術とAIを活用したリアルタイム監視システムを開発する：

- **設備監視の効率化**: 人手による目視確認から自動監視への転換
- **予知保全の実現**: データ分析による故障予測と計画的メンテナンス
- **運用コストの削減**: ダウンタイム削減と効率的な設備運用
- **生産性の向上**: リアルタイムデータに基づく意思決定の実現

### 1.2 背景
- 多くの生産設備を同時に監視する必要があり、監視対象が多岐にわたる
- 専門知識を持ったスタッフが不足し、24時間体制での監視が困難
- データの統合・分析が困難で、異常やトラブルの早期発見ができない
- 予知保全が実現できず、突発的な故障によるダウンタイムが発生

### 1.3 期待される成果
- **稼働率向上**: 30-40%の改善
- **故障率削減**: 10-15%の削減
- **メンテナンスコスト削減**: 20%の削減
- **異常検知時間短縮**: 従来比80%削減

## 2. 対象ユーザーや利用シーン

### 2.1 主要ユーザー（アクター）

#### 2.1.1 設備管理者
**役割**: 設備の日常的な監視と管理
**利用シーン**:
- 日常の設備稼働状況の監視
- 異常発生時の初期対応
- 設備パフォーマンスの確認
- 稼働データの記録と管理

#### 2.1.2 保守技術者
**役割**: 設備のメンテナンスと修理
**利用シーン**:
- 予知保全計画の立案と実行
- 故障診断と修理作業
- メンテナンス履歴の記録
- 部品交換の計画と実施

#### 2.1.3 工場長
**役割**: 工場全体の運営と意思決定
**利用シーン**:
- 生産効率の分析と改善計画の策定
- 設備投資の意思決定
- 全体的な生産計画の調整
- 経営層への報告資料作成

#### 2.1.4 システム管理者
**役割**: 監視システムの運用と管理
**利用シーン**:
- システムの運用監視
- データベースの管理
- セキュリティ設定の管理
- システム障害時の復旧作業

### 2.2 副次ユーザー

#### 2.2.1 品質管理者
**利用シーン**: 製品品質と設備状態の関連監視

#### 2.2.2 生産計画者
**利用シーン**: 設備稼働状況を考慮した生産計画策定

## 3. 主要な機能やサービス

### 3.1 リアルタイム監視機能
**機能概要**: 工場設備の稼働状況をリアルタイムで監視
**詳細機能**:
- 設備稼働状態の表示（稼働中/停止中/異常）
- センサーデータの収集と表示（温度、振動、電流値等）
- 稼働時間と効率の計算・表示
- リアルタイムダッシュボードの提供

### 3.2 異常検知・アラート機能
**機能概要**: 設備の異常を自動検知し、関係者に通知
**詳細機能**:
- 閾値ベースの異常検知
- 異常パターンの機械学習による検知
- 異常レベルの自動判定（軽微/重要/緊急）
- レベル別通知機能（ダッシュボード表示/メール/SMS/音声アラート）

### 3.3 予知保全管理機能
**機能概要**: データ分析による故障予測と保全計画
**詳細機能**:
- 設備の健康状態診断
- 故障予測時期の算出
- 推奨メンテナンス時期の提案
- メンテナンススケジュールの管理
- 必要部品と作業内容の提示

### 3.4 データ分析・レポート機能
**機能概要**: 蓄積データの分析と効率改善提案
**詳細機能**:
- 設備稼働率の推移分析
- 生産効率の変化分析
- ボトルネック設備の特定
- 改善提案の生成
- 分析レポートの自動生成・配信

### 3.5 データ統合管理機能
**機能概要**: 複数データソースの統合と品質管理
**詳細機能**:
- 各種センサーデータの収集
- データの整合性チェック
- 統一フォーマットへの変換
- データ品質レポートの生成
- 履歴データの管理

## 4. 画面や操作

### 4.1 メインダッシュボード
**画面概要**: 工場全体の設備状況を一覧表示
**主要機能**:
- 設備稼働状況のマップ表示
- リアルタイムセンサーデータ表示
- 異常アラートの表示
- クイックアクセスメニュー

**操作**:
- 設備アイコンクリックで詳細画面へ遷移
- フィルター機能による表示設備の絞り込み
- 時系列グラフの時間軸調整

### 4.2 設備詳細画面
**画面概要**: 個別設備の詳細情報表示
**主要機能**:
- センサーデータの時系列グラフ表示
- 稼働統計情報の表示
- メンテナンス履歴の表示
- 異常履歴の表示

**操作**:
- グラフの拡大・縮小操作
- データエクスポート機能
- メンテナンス記録の入力

### 4.3 アラート管理画面
**画面概要**: 発生したアラートの管理
**主要機能**:
- アクティブアラートの一覧表示
- アラート履歴の表示
- アラート処理状況の管理

**操作**:
- アラートの確認・承認操作
- 処理結果の記録
- アラート設定の変更

### 4.4 メンテナンス管理画面
**画面概要**: 保全計画と実績の管理
**主要機能**:
- メンテナンススケジュールの表示
- 作業指示書の生成
- 実績記録の入力
- 部品在庫状況の表示

**操作**:
- スケジュールの登録・変更
- 作業完了の記録
- 次回メンテナンス予定の設定

### 4.5 分析レポート画面
**画面概要**: 各種分析結果の表示
**主要機能**:
- 設備効率分析の表示
- 改善提案の表示
- カスタムレポートの作成
- レポートの共有機能

**操作**:
- 分析期間の設定
- レポート形式の選択
- PDFエクスポート機能

## 5. 外部サービスとのやり取り

### 5.1 IoTセンサーとの連携
**連携内容**: リアルタイムセンサーデータの収集
**通信方式**: MQTT over TCP/IP
**データ形式**: JSON形式
**取得データ**:
- 温度データ
- 振動データ
- 電流値データ
- 稼働状態データ

### 5.2 Azure IoT Hubとの連携
**連携内容**: センサーデータの中継・前処理
**通信方式**: HTTPS/AMQP
**機能**:
- デバイス認証
- データルーティング
- メッセージ変換

### 5.3 メール・SMS通知サービスとの連携
**連携内容**: アラート通知の配信
**使用サービス**: Azure Communication Services
**通知タイミング**:
- 緊急アラート発生時
- 定期レポート配信時
- システム障害発生時

### 5.4 外部ERPシステムとの連携（将来対応）
**連携内容**: 部品発注・在庫管理システムとの連携
**通信方式**: REST API
**連携データ**:
- 部品在庫情報
- 発注情報
- 作業実績情報

## 6. 他のアプリケーションやサービスとの依存関係

### 6.1 クラウドサービス依存関係

#### 6.1.1 Azure Functions
**依存関係**: データ処理とビジネスロジックの実行基盤
**重要度**: 高（システム中核機能）
**障害時影響**: データ処理停止、アラート機能停止

#### 6.1.2 Azure Cosmos DB
**依存関係**: リアルタイムデータの高速アクセス
**重要度**: 高（リアルタイム監視機能）
**障害時影響**: リアルタイム監視機能停止

#### 6.1.3 Azure SQL Database
**依存関係**: マスターデータと履歴データの管理
**重要度**: 中（分析・レポート機能）
**障害時影響**: 分析機能・レポート機能の制限

#### 6.1.4 Power BI
**依存関係**: データ可視化とダッシュボード機能
**重要度**: 中（ユーザーインターフェース）
**障害時影響**: ダッシュボード表示不可

### 6.2 開発・運用ツール依存関係

#### 6.2.1 Visual Studio Code
**依存関係**: 開発環境
**重要度**: 高（開発時のみ）
**用途**: ソースコード編集、デバッグ

#### 6.2.2 Python 3.9以上
**依存関係**: 実行環境
**重要度**: 高（システム実行基盤）
**用途**: アプリケーション実行、データ処理

#### 6.2.3 Azure CLI
**依存関係**: デプロイメント・管理ツール
**重要度**: 中（運用管理）
**用途**: リソース管理、デプロイメント

### 6.3 ネットワーク・インフラ依存関係

#### 6.3.1 インターネット接続
**依存関係**: クラウドサービスへのアクセス
**重要度**: 高（システム全体）
**障害時影響**: システム全体停止

#### 6.3.2 工場内ネットワーク
**依存関係**: IoTセンサーとの通信
**重要度**: 高（データ収集）
**障害時影響**: センサーデータ収集停止

#### 6.3.3 VPN接続（リモートアクセス用）
**依存関係**: 外部からのシステムアクセス
**重要度**: 中（リモート運用）
**障害時影響**: リモートアクセス不可

### 6.4 セキュリティサービス依存関係

#### 6.4.1 Azure Active Directory
**依存関係**: ユーザー認証・認可
**重要度**: 高（セキュリティ）
**障害時影響**: ログイン不可

#### 6.4.2 Azure Key Vault
**依存関係**: 機密情報管理
**重要度**: 高（セキュリティ）
**障害時影響**: 外部サービス接続不可

## 7. 機能優先度

### 7.1 最高優先度（Phase 1）
- リアルタイム監視機能
- 異常検知・アラート機能
- メインダッシュボード

### 7.2 高優先度（Phase 2）
- 予知保全管理機能
- 設備詳細画面
- アラート管理画面

### 7.3 中優先度（Phase 3）
- データ分析・レポート機能
- メンテナンス管理画面
- 分析レポート画面

### 7.4 低優先度（将来対応）
- 外部ERPシステムとの連携
- 高度な分析機能
- カスタムレポート機能

---

**文書作成日**: 2024年12月19日  
**作成者**: AI-Driven Development Team  
**承認者**: プロジェクトマネージャー  
**版数**: 1.0